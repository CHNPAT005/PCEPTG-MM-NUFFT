## Author: Patrick Chang
# Script file to test the various Fejer implementations
# to ensure they are all self consistent

cd("/Users/patrickchang/Desktop/Stats Masters/Masters Dissertation/Code/PCEPTG-MM-NUFFT")

using StatsBase
include("../Correlation Estimators/Fejer/CFTcorrFK")
include("../Correlation Estimators/Fejer/FFTcorrFK")
include("../Correlation Estimators/Fejer/KANcorrFK")
include("../Correlation Estimators/Fejer/MScorrFK")
include("../Correlation Estimators/Fejer/NUFFTcorrFK-FT")
include("../Correlation Estimators/Fejer/NUFFTcorrFK-FINUFFT")
include("../Correlation Estimators/Fejer/NUFFTcorrFK-FGG")
include("../Correlation Estimators/Fejer/NUFFTcorrFK-NG")
include("../Correlation Estimators/Fejer/NUFFTcorrFK-KB")
include("../Correlation Estimators/Fejer/NUFFTcorrFK-NKB")
include("../Monte Carlo Simulation Algorithms/GBM")

#---------------------------------------------------------------------------
## Synchronous Case

mu = [0.01/86400, 0.01/86400]
sigma = [0.1/86400 sqrt(0.1/86400)*0.35*sqrt(0.2/86400);
        sqrt(0.1/86400)*0.35*sqrt(0.2/86400) 0.2/86400]

P = GBM(10000, mu, sigma, seed = 10)
t = reshape([collect(1:1:10000.0); collect(1:1:10000.0)], 10000, 2)

#--------------------

s1 = CFTcorrFK(P, t)
s2 = FFTcorrFK(P)
s3 = KANcorrFK(P[:,1], P[:,2], t[:,1], t[:,2])
s4 = NUFFTcorrFKFT(P, t)
s5 = MScorrFK(P[:,1], P[:,2], t[:,1], t[:,2])
s6 = NUFFTcorrFKFINUFFT(P, t)
s7 = NUFFTcorrFKFGG(P, t)
s8 = NUFFTcorrFKNG(P, t)
s9 = NUFFTcorrFKKB(P, t)
s10 = NUFFTcorrFKNKB(P, t)

#---------------------------------------------------------------------------
## Asynchronous Case (Down-sampled 40%)

rm1 = sample(2:9999, 4000, replace = false)
rm2 = sample(2:9999, 4000, replace = false)

P[rm1, 1] .= NaN
t[rm1, 1] .= NaN
P[rm2, 2] .= NaN
t[rm2, 2] .= NaN

#--------------------
# Can't include FFTcorrDK

as1 = CFTcorrFK(P, t)
as2 = KANcorrFK(P[:,1], P[:,2], t[:,1], t[:,2])
as3 = NUFFTcorrFKFT(P, t)
as4 = MScorrFK(P[:,1], P[:,2], t[:,1], t[:,2])
as5 = NUFFTcorrFKFINUFFT(P, t)
as6 = NUFFTcorrFKFGG(P, t)
as7 = NUFFTcorrFKNG(P, t)
as8 = NUFFTcorrFKKB(P, t)
as9 = NUFFTcorrFKNKB(P, t)

# TODO: Kanatani Implementation still problamatic, still needs fixing
